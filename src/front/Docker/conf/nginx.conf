# j'utilise reverse proxy pour rediriger le trafic vers l'appli Django

worker_processes auto;

events {
    worker_connections 1024;
}

http
{
    # ameliore l'efficacite de la transmission de fichiers par le serveur
    sendfile on;

    server
    {
        listen 443 ssl;
        # listen [::]:443 ssl;

        #indique que la connection sera fait depuis cet host
        server_name localhost;

        # / signifie que cette configuration s'appliquera a toutes les requetes pour l'adresse principale du site
        location /
        {
            # Redirige vers l'addr de votre application Django/backend
            proxy_pass http://localhost:8000;
            # Definit l'en-tete HTTP Host Ã  la valeur du nom d'hote du client
            # pour que l'application Django determine le nom de domaine d'origine de la requete
            proxy_set_header Host $host;
            # pour obtenir l'addr IP reelle du client lorsque Nginx est utilise comme proxy
            proxy_set_header X-Real-IP $remote_addr;
            # pour suivre la chaine d'addr IP lorsque plusieurs proxies sont impliques
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            # indique a Django le nom du serveur d'origine de la requete
            proxy_set_header X-Forwarded-Host $server_name;
        }
    }
}